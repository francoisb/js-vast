/* js-vast - https://github.com/francoisb/js-vast */
"use strict";!function(a,b,c,d){if("object"==typeof c.module){if(b&&c.require)for(var e=0;e<b.length;e++)c[b[e]]=c.require(b[e]);c.module.exports=d.apply(c)}else if("function"==typeof c.define&&c.define.amd)define("js-vast",b||[],d);else{if(b&&c.require)for(var e=0;e<b.length;e++)b[e]=c[b[e]];c["js-vast"]=d.call(c,b)}}(0,[],this||{},function(){var a={compatibility:{},models:{},players:{companion:{},mediafile:{}},xml:{}};return a.compatibility.video=function(){var a=["probably","maybe"],b=document.createElement("video");return!(void 0===b||!b.canPlayType)&&{ogg:-1!==a.indexOf(b.canPlayType('video/ogg; codecs="theora"')),h264:-1!==a.indexOf(b.canPlayType('video/mp4; codecs="avc1.42E01E"')),webm:-1!==a.indexOf(b.canPlayType('video/webm; codecs="vp8, vorbis"'))}}(),a.players.Base=function(){function a(a){this.container=a||window.document.body,this._listeners={}}return a.prototype.constructor=a,a.MAX_HEIGHT=600,Object.defineProperties(a.prototype,{compatible:{get:function(){return!0}}}),a.prototype.trigger=function(a,b){function c(a,b){if(void 0!==d._listeners[a]){var c;for(c=0;c<d._listeners[a].length;c++)d._listeners[a][c].apply(void 0,b)}}var d=this;return b=b||[],void 0!==d._listeners[a]?c(a,b):c("default",[a,b]),c("*",[a,b]),this},a.prototype.bind=function(a,b){return void 0===this._listeners[a]&&(this._listeners[a]=[]),this._listeners[a].push(b),this},a.prototype.unbind=function(a,b){if(void 0!==this._listeners[a])if(void 0!==b)for(var c=this._listeners[a].length-1;c>=0;c--)this._listeners[a][c]===b&&this._listeners[a][c].splice(c,1);else this._listeners[a]=[],delete this._listeners[a];return this},a.prototype.unbindAll=function(){return this._listeners={},this},a.prototype.print=function(a,b,c){if(!this.compatible)throw Error("Player is not compatible!");return this._append(this.container,b,c),this._init(a,b,c),this},a.prototype._append=function(a,b,c){return this},a.prototype._init=function(a,b,c){return this},a}(),a.players.companion.Html=function(a){function b(){a.apply(this,arguments)}return b.prototype=new a,b.prototype.constructor=b,b.prototype._append=function(a,b,c){var d=document.createElement("div");return d.style="width: "+b.width+"px; height: "+b.height+";",d.innerHTML=b.resource,a.appendChild(d),this},b.prototype._init=function(a,b){return this.trigger("ready",[a]),a.tracking.send("creativeView"),this},b}(a.players.Base),a.players.companion.Iframe=function(a){function b(){a.apply(this,arguments)}return b.prototype=new a,b.prototype.constructor=b,b.prototype._append=function(a,b,c){var d=document.createElement("iframe");return d.width=b.width,d.height=b.height,d.frameborder="0",d.scrolling="no",d.src=b.resource,a.appendChild(d),this},b.prototype._init=function(a,b){return this.trigger("ready",[a]),a.tracking.send("creativeView"),this},b}(a.players.Base),a.players.companion.Image=function(a){function b(){a.apply(this,arguments)}return b.prototype=new a,b.prototype.constructor=b,b.prototype._append=function(a,b,c){var d=document.createElement("img");if(d.width=b.width,d.height=b.height,d.src=b.resource,b.target){var e=document.createElement("a");e.target="_blank",e.href=b.target,e.appendChild(d),a.appendChild(e)}else a.appendChild(d);return this},b.prototype._init=function(a,b){return this.trigger("ready",[a]),a.tracking.send("creativeView"),this},b}(a.players.Base),a.players.mediafile.Flash=function(a){function b(){a.apply(this,arguments)}var c,d=0;return c=-1!=navigator.appName.indexOf("Microsoft")?function(a){return window[a]}:function(a){return document[a]},b.prototype=new a,b.prototype.constructor=b,Object.defineProperties(b,{compatible:{get:function(){return window.swfobject&&window.swfobject.embedSWF}}}),b.prototype._append=function(b,c,d){var e=1,f=document.createElement("div");c.width>a.MAX_HEIGHT&&(e=vidElm.width/a.MAX_HEIGHT),f.id="flashContent",f.style="width: "+Math.round(c.width*e)+"px; height: "+Math.round(c.height*e)+"px;",b.appendChild(f)},b.prototype._init=function(a,b,e){function f(){for(var a in h)clearTimeout(h[a])}d++;var g=this,h=[],i={};return window.adPlayerEventHandler={onPlayerReady:function(a){if(!i.ready){i.ready=!0,g.trigger("ready");c("flash-ad-player").setAdParameters(b.url,b.mimetype,e.adParameters||"")}},onAdError:function(a,b,c){f(),g.trigger("error",[{error:{id:b,message:c}}])},onAdStarted:function(b){if(!i["ad.started"]&&(i["ad.started"]=!0,g.trigger("ad.started"),(!e.adParameters||!e.adParameters.length)&&(a.tracking.send("Impression"),e.tracking&&(e.tracking.send("Started"),e.tracking.send("Start"),e.duration&&e.duration>0)))){var c=Math.round(e.duration/4);c>0&&(e.tracking.hasEvent("FirstQuartile")&&(h.FirstQuartile=setTimeout(function(){window.adPlayerEventHandler.onAdFirstQuartile(b)},1*c)),e.tracking.hasEvent("MidPoint")&&(h.MidPoint=setTimeout(function(){window.adPlayerEventHandler.onAdMidPoint(b)},2*c)),e.tracking.hasEvent("ThirdQuartile")&&(h.ThirdQuartile=setTimeout(function(){window.adPlayerEventHandler.onAdThirdQuartile(b)},3*c)))}},onAdVideoComplete:function(a){i["ad.complete"]||(f(),i["ad.complete"]=!0,g.trigger("ad.complete"),e.adParameters&&e.adParameters.length||!e.tracking||e.tracking.send("Complete"))},onAdMidPoint:function(a){i["ad.mid-point"]||(i["ad.mid-point"]=!0,g.trigger("ad.mid-point"),e.adParameters&&e.adParameters.length||!e.tracking||e.tracking.send("MidPoint"))},onAdPaused:function(a){g.trigger("ad.paused"),e.adParameters&&e.adParameters.length||!e.tracking||e.tracking.send("Paused")},onAdResume:function(a){g.trigger("ad.resume"),e.adParameters&&e.adParameters.length||!e.tracking||e.tracking.send("Resume")},onAdFirstQuartile:function(a){i["ad.first-quartile"]||(i["ad.first-quartile"]=!0,g.trigger("ad.first-quartile"),e.adParameters&&e.adParameters.length||!e.tracking||e.tracking.send("FirstQuartile"))},onAdThirdQuartile:function(a){i["ad.third-quartile"]||(i["ad.third-quartile"]=!0,g.trigger("ad.third-quartile"),e.adParameters&&e.adParameters.length||!e.tracking||e.tracking.send("ThirdQuartile"))},onAdPlaying:function(a){i["ad.playing"]||(i["ad.playing"]=!0,g.trigger("ad.playing"),e.adParameters&&e.adParameters.length||!e.tracking||e.tracking.send("Playing"))},onAdClick:function(a){if(g.trigger("ad.click"),(!e.adParameters||!e.adParameters.length)&&e.target){var b=window.open(e.target,"_blank");b?(b.focus(),e.tracking&&e.tracking.send("Click")):g.trigger("ad.blocker")}}},swfobject.embedSWF("sponsors/spotxchange/player-1.0.swf","flashContent",b.width,b.height,"10.0.0","",{adPlayerId:d},{quality:"high",bgcolor:"#ffffff",allowscriptaccess:"always",allowfullscreen:"true",menu:"true",wmode:"transparent"},{id:"flash-ad-player",name:"flash-ad-player",align:"middle",onmouseup:"adPlayerEventHandler.onAdClick("+d+")"}),swfobject.createCSS("#flashContent","display:block;text-align:center;"),this},b}(a.players.Base),a.players.mediafile.Html5=function(b){function c(){b.apply(this,arguments)}var d=0;return c.prototype=new b,c.prototype.constructor=c,Object.defineProperties(c,{compatible:{get:function(){return a.compatibility.video}}}),c.prototype._append=function(a,c,e){d++;var f=1,g=document.createElement("source"),h=document.createElement("video");return g.src=c.url,g.type=c.mimetype,c.width>b.MAX_HEIGHT&&(f=h.width/b.MAX_HEIGHT),h.id="mediafile-html5-"+d,h.width=Math.round(c.width*f),h.height=Math.round(c.height*f),h.appendChild(g),a.appendChild(h),this},c.prototype._init=function(a,b,c){var e=this,f=document.getElementById("mediafile-html5-"+d);if(_firedEvents={},_muted=!1,f.addEventListener("error",function(a){e.trigger("error",[])},!0),f.addEventListener("timeupdate",function(b){if(!(f.duration<1)&&(_firedEvents["ad.started"]||(_firedEvents["ad.started"]=!0,e.trigger("ad.started"),c.tracking&&(a.tracking.send("Impression"),c.tracking.send("Started"),c.tracking.send("Start"))),c.tracking)){var d=Math.round(f.duration/4);d>0&&(!_firedEvents["ad.first-quartile"]&&f.currentTime<=d&&(_firedEvents["ad.first-quartile"]=!0,e.trigger("ad.first-quartile"),c.tracking.send("FirstQuartile")),!_firedEvents["ad.mid-point"]&&f.currentTime<=2*d&&(_firedEvents["ad.mid-point"]=!0,e.trigger("ad.mid-point"),c.tracking.send("MidPoint")),!_firedEvents["ad.third-quartile"]&&f.currentTime<=3*d&&(_firedEvents["ad.third-quartile"]=!0,e.trigger("ad.third-quartile"),c.tracking.send("ThirdQuartile")))}},!0),f.addEventListener("ended",function(a){_firedEvents["ad.complete"]||(_firedEvents["ad.complete"]=!0,e.trigger("ad.complete"),c.tracking&&c.tracking.send("Complete"))},!0),f.addEventListener("play",function(a){f.paused?(e.trigger("ad.resume"),c.tracking&&c.tracking.send("Resume")):_firedEvents["ad.playing"]||(_firedEvents["ad.playing"]=!0,e.trigger("ad.playing"),c.tracking&&c.tracking.send("Playing"))},!0),f.addEventListener("pause",function(a){e.trigger("ad.paused"),c.tracking&&(c.tracking.send("Paused"),c.tracking.send("Pause"))},!0),f.addEventListener("volumechange",function(a){video.muted?_muted||(_muted=!0,e.trigger("ad.muted"),c.tracking&&(c.tracking.send("Muted"),c.tracking.send("Mute"))):_muted&&(_muted=!1,e.trigger("ad.unmuted"),c.tracking&&(c.tracking.send("UnMuted"),c.tracking.send("UnMute")))},!1),f.addEventListener("click",function(a){if(e.trigger("ad.click"),c.target){var b=window.open(c.target,"_blank");b?(b.focus(),c.tracking&&c.tracking.send("Click")):e.trigger("ad.blocker")}},!0),!_firedEvents.ready)return _firedEvents.ready=!0,this.trigger("ready"),f.play(),this},c}(a.players.Base),a.models.Tracking=function(){function a(){this._events=[]}return a.prototype.constructor=a,a.prototype.addEvent=function(a,b){return this._events.push({name:a,url:b}),this},a.prototype.hasEvent=function(a){a=a.toLowerCase();for(var b=0;b<this._events.length;b++)if(this._events[b].name.toLowerCase()===a)return!0;return!1},a.prototype.getEvent=function(a){var b=[];a=a.toLowerCase();for(var c=0;c<this._events.length;c++)this._events[c].name.toLowerCase()===a&&b.push(this._events[c].url);return b},a.prototype.send=function(a){var b=[],c=this.getEvent(a);if(c.length)for(var d=0;d<c.length;d++)b.push(new Image(1,1)),b[d].src=c[d];return results},a.prototype.clone=function(){var a=new this.constructor;return a._events=this._events.slice(0),a},a}(),a.models.Ad=function(a){function b(a){this.name="InvalidError",this.message=a}function c(b,c,d,e,f){this.id=b,this.type=c,this.system=d,this.title=e,this.description=f,this.tracking=new a,this.creatives=[],this.extensions=[]}return b.prototype=Error.prototype,b.prototype.constructor=b,c.prototype.constructor=c,Object.defineProperties(c.prototype,{isWrapper:{get:function(){return"wrapper"===this.type.toLowerCase()}}}),c.prototype.addCreative=function(a){return this.creatives.push(a),this},c.prototype.clone=function(){var a=new this.constructor(this.id,this.type,this.system,this.title,this.description);a.tracking=this.tracking.clone(),a.extensions=this.extensions.slice(0);for(var b=0;b<this.creatives.length;b++)a.addCreative(this.creatives[b].clone());return a},c.createFromInstance=function(a,d,e,f,g,h){if(!a||a.constructor!==c)throw new b('The parameter "record" must be a VastModelAd instance.');var i=a.clone(),j=i.creatives.slice(0);return i.creatives=[],d&&d.length&&(i.id=d),e&&e.length&&(i.type=e),f&&f.length&&(i.system=f),g&&g.length&&(i.title=g),h&&h.length&&(i.description=h),j.length>0&&(i.addCreative=function(a){if("linear"===a.type)for(var b=0;b<j.length;b++)j[b].type===a.type&&(a.tracking._events=a.tracking._events.concat(j[b].tracking._events)),a.target&&a.target.length||(a.target=j[b].target),a.parameters||(a.parameters=j[b].parameters);return this.creatives.push(a),this}),i},c}(a.models.Tracking),a.models.Companion=function(a,b,c,d){function e(b,c,d,e,f){this.width=b,this.height=c,this.type=d,this.resource=e,this.target=f,this.tracking=new a}return e.prototype.constructor=e,Object.defineProperties(e.prototype,{player:{get:function(){switch(this.type){case"html":return b;case"iframe":return c;case"image":return d;default:return null}}}}),e.prototype.clone=function(){var a=new this.constructor(this.width,this.height,this.type,this.resource,this.target);return a.tracking=this.tracking.clone(),a},e}(a.models.Tracking,a.players.companion.Html,a.players.companion.Iframe,a.players.companion.Image),a.models.CreativeCompanion=function(a){function b(){this.companions=[]}return b.prototype.constructor=b,Object.defineProperties(b.prototype,{type:{get:function(){return"companion"}},playerParameters:{get:function(){return{}}}}),b.prototype.getCompanionsByType=function(a){for(var b,c=[],b=0;b<=this.companions.length;b++)this.companions[b].type===a&&c.push(this.companions[b]);return c},b.prototype.clone=function(){for(var a=new this.constructor,b=0;b<this.companions.length;b++)a.companions.push(this.companions[b].clone());return a},b}(a.models.Tracking),a.models.CreativeLinear=function(a){function b(b,c){this.duration=b,this.target=c,this.mediafiles=[],this.parameters=null,this.tracking=new a}return b.prototype.constructor=b,Object.defineProperties(b.prototype,{type:{get:function(){return"linear"}},playerParameters:{get:function(){var a,b=0;return this.duration&&this.duration.length&&(a=this.duration.split(":"),3===a.length&&(b=36e5*parseInt(a[0])+6e4*parseInt(a[1])+1e3*parseInt(a[2]))),{duration:b,tracking:this.tracking,adParameters:this.parameters,target:this.target}}}}),b.prototype.clone=function(){var a=new this.constructor(this.duration,this.target);this.parameters&&(this.parameters.constructor===Array?a.parameters=this.parameters.slice(0):"object"==typeof this.parameters?a.parameters=JSON.parse(JSON.stringify(this.parameters)):a.parameters=this.parameters),a.tracking=this.tracking.clone();for(var b=0;b<this.mediafiles.length;b++)a.mediafiles.push(this.mediafiles[0].clone());return a},b}(a.models.Tracking),a.models.MediaFile=function(b,c){function d(a,b,c,d,e,f,g){this.url=a,this.delivery=b,this.mimetype=c,this.api=d,this.bitrate=e,this.width=f,this.height=g}return d.prototype.constructor=d,Object.defineProperties(d.prototype,{player:{get:function(){switch(this.mimetype){case"application/x-shockwave-flash":case"video/x-flv":return b;case"video/mp4":return a.compatibility.video&&a.compatibility.video.h264?c:null;case"video/webm":return a.compatibility.video&&a.compatibility.video.webm?c:null;case"video/ogg":return a.compatibility.video&&a.compatibility.video.ogg?c:null;default:return null}}}}),d.prototype.clone=function(){return new this.constructor(this.url,this.delivery,this.mimetype,this.api,this.bitrate,this.width,this.height)},d}(a.players.mediafile.Flash,a.players.mediafile.Html5),a.xml.Loader=function(){function a(a){this.name="CompatibilityError",this.message=a}function b(a){this.name="ParameterError",this.message=a}function c(a){this.url=a,this._content=null}a.prototype=Error.prototype,a.prototype.constructor=a,b.prototype=Error.prototype,b.prototype.constructor=b;var d=null;return window.XMLHttpRequest?d=function(){return new window.XMLHttpRequest}:window.ActiveXObject&&(d=function(){return new window.ActiveXObject("Microsoft.XMLHTTP")}),c.prototype.constructor=c,Object.defineProperties(c.prototype,{compatible:{get:function(){return!(!window.jQuery||!window.jQuery.ajax)||null!==d}}}),c.prototype.load=function(c,e,f){if(c&&c!==this.url&&(this.url=c,this._content=null),!this.compatible)throw new a("");if(!this.url)throw new b("An url is required!");if(window.jQuery&&window.jQuery.ajax)window.jQuery.ajax({async:!0,type:"GET",url:c,dataType:"xml",success:function(a){e(a)},error:function(b,c,d){throw f(c,d),new a(c)}});else{var g=d();g.overrideMimeType("text/xml"),g.onload=function(){if(4===g.readyState){if(200!==g.status)throw"function"==typeof f&&f(g.statusText,null),new a(g.statusText);"function"==typeof e&&e(g.responseXML)}},g.onerror=function(b){throw f(g.statusText,b),new a(g.statusText)},g.open("GET",this.url,!0),g.send(null)}return this},c}(),a.xml.Parser=function(a,b,c,d,e,f,g){function h(a){this.name="ParameterError",this.message=a}function j(a){return a&&(a.textContent||a.text)}function k(a,b){if(a){var c,d,e,f;if(f=a.childNodes)for(d=0,e=f.length;d<e;d++)if(c=f[d],c.nodeName===b)return c}return!1}function l(a,b){if(a){var c,d,e,f,g;if(d=[],g=a.childNodes)for(e=0,f=g.length;e<f;e++)c=g[e],c.nodeName===b&&d.push(c)}return d}function m(a){var b={};if(1==a.nodeType){if(a.attributes.length>0){b["@attributes"]={};for(var c=0;c<a.attributes.length;c++){var d=a.attributes.item(c);b["@attributes"][d.nodeName]=d.value}}}else 3==a.nodeType&&(b=a.value);if(a.hasChildNodes())for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes.item(e),g=f.nodeName;if(void 0===b[g])b[g]=m(f);else{if(void 0===b[g].push){var h=b[g];b[g]=[],b[g].push(h)}b[g].push(m(f))}}return b}function n(a,b){var c,d=l(k(a,"TrackingEvents"),"Tracking");if(b||(b=new g),d&&d.length)for(c=0;c<d.length;c++)b.addEvent(d[c].getAttribute("event"),j(d[c]));return b}function o(a){var b,c=l(k(a,"MediaFiles"),"MediaFile"),d=[];if(c&&c.length)for(b=0;b<c.length;b++)d.push(new f(j(c[b]),c[b].getAttribute("delivery"),c[b].getAttribute("type"),c[b].getAttribute("apiFramework"),c[b].getAttribute("bitrate"),c[b].getAttribute("width"),c[b].getAttribute("height")));return d}function p(a){var b,c,d,e;return b||(e=l(a,"StaticResource"))&&e.length>0&&(b=["static",j(e[0])],(c=e[0].getAttribute("creativeType"))&&(d=c.indexOf("/"),b[0]=-1!==d?c.substr(0,d):c)),b||(e=l(a,"HTMLResource"))&&e.length>0&&(b=["html",j(e[0])]),b||(e=l(a,"Code"))&&e.length>0&&(b=["html",j(e[0])]),b||(e=l(a,"IFrameResource"))&&e.length>0&&(b=["iframe",j(e[0])]),b}function q(a){var b,c=j(k(k(a,"VideoClicks"),"ClickTracking"));return b=new e(j(k(a,"Duration")),j(k(k(a,"VideoClicks"),"ClickThrough"))),b.parameters=j(k(a,"AdParameters")),b.mediafiles=o(a),n(a,b.tracking),c&&c.length&&b.tracking.addEvent("click",c),b}function r(a){var b,e,f,g;for(b=new d,e=l(a,"Companion"),i=0;i<e.length;i++)g=p(e[i]),f=new c(e[i].getAttribute("width"),e[i].getAttribute("height"),g[0],g[1],j(k(e[i],"CompanionClickThrough"))),n(e[i],f.tracking),b.companions.push(f);return b}function s(c){function d(c,e,f){var g,h,i,n,o,p,s,t={Linear:q,CompanionAds:r};if(h=e.nodeName,p=e.getElementsByTagName("AdSystem"),o=j(p[0]),p=e.getElementsByTagName("AdTitle"),i=j(p[0]),p=e.getElementsByTagName("Description"),n=j(p[0]),s=f&&f.constructor===b?b.createFromInstance(f,c,h,o,i,n):new b(c,h,o,i,n),p=k(e,"Error"),p&&s.tracking.addEvent("error",j(p)),(p=l(e,"Impression"))&&p.length>0)for(var u=0;u<p.length;u++)s.tracking.addEvent("impression",j(p[u]));if((p=l(k(e,"Creatives"),"Creative"))&&p.length>0)for(var u=0;u<p.length;u++)for(var v in t)if((g=p[u].getElementsByTagName(v))&&g.length>0)for(var w=0;w<g.length;w++)s.addCreative(t[v](g[w]));if((p=l(k(e,"Extensions"),"Extension"))&&p.length>0)for(var u=0;u<p.length;u++)s.extensions.push(m(p[u]));return s.isWrapper&&function(){function b(a){if(a&&(p=a.getElementsByTagName("InLine"))&&p.length>0)for(var b=0;b<p.length;b++)s=d(c,p[b],s)}var f=new a;p=e.getElementsByTagName("VASTAdTagURI"),p&&p.length>0?f.load(j(p[0]),b):(p=e.getElementsByTagName("VASTAdTagURL"))&&p.length>0&&xmlLoader.load(j(p[0]),b)}(),s}for(var e,f=["InLine","Wrapper"],g=[],h=c.getElementsByTagName("Ad"),i=0;i<h.length;i++)for(var n=0;n<f.length;n++)if((e=h[i].getElementsByTagName(f[n]))&&e.length)for(var o=0;o<e.length;o++)g.push(d(h[i].getAttribute("id"),e[o]));return g}function t(a){this.xmlDoc=a,this._valid=null,this._parsedContent=null}return h.prototype=Error.prototype,h.prototype.constructor=h,t.prototype.constructor=t,Object.defineProperties(t.prototype,{version:{get:function(){return this.valid?this.xmlDoc.firstChild.getAttribute("version"):null}},valid:{get:function(){return null===this._valid&&(this._valid=!1,this.xmlDoc&&this.xmlDoc.firstChild&&this.xmlDoc.firstChild.nodeName&&"VAST"===(this.xmlDoc.firstChild.nodeName+"").toUpperCase()&&(this._valid=!0)),this._valid}}}),t.prototype.parse=function(a){if(a&&a!==this.xmlDoc&&(this.xmlDoc=a,this._valid=null,this._parsedContent=null),!this.valid)throw new h("The resource is not a valid VAST format.");return null===this._parsedContent&&(this._parsedContent=s(this.xmlDoc)),this._parsedContent},t}(a.xml.Loader,a.models.Ad,a.models.Companion,a.models.CreativeCompanion,a.models.CreativeLinear,a.models.MediaFile,a.models.Tracking),a.Client=function(a,b){function c(a){this.container=a,this._listeners={}}return c.prototype.constructor=c,Object.defineProperties(c.prototype,{_xmlParser:{get:function(){var a=null;return function(){return null===a&&(a=new b),a}}()},_xmlLoader:{get:function(){var b=null;return function(){return null===b&&(b=new a),b}}()}}),c.prototype.trigger=function(a,b){function c(a,b){if(void 0!==d._listeners[a]){var c;for(c=0;c<d._listeners[a].length;c++)d._listeners[a][c].apply(void 0,b)}}var d=this;return b=b||[],void 0!==d._listeners[a]?c(a,b):c("default",[a,b]),c("*",[a,b]),this},c.prototype.bind=function(a,b){return void 0===this._listeners[a]&&(this._listeners[a]=[]),this._listeners[a].push(b),this},c.prototype.unbind=function(a,b){if(void 0!==this._listeners[a])if(void 0!==b)for(var c=this._listeners[a].length-1;c>=0;c--)this._listeners[a][c]===b&&this._listeners[a][c].splice(c,1);else this._listeners[a]=[],delete this._listeners[a];return this},c.prototype.unbindAll=function(){return this._listeners={},this},c.prototype.run=function(a){var b=this;this._xmlLoader.load(a,function(a){b.trigger("xml.loaded",[a]);var c=b._xmlParser.parse(a);b.trigger("xml.parsed",[c]);var d,e,f,g=null;if(c)for(var h=0;h<c.length&&!g;h++){d=c[h];for(var i=0;i<d.creatives.length&&!g;i++)if(e=d.creatives[i],"linear"===e.type)for(var j=0;j<e.mediafiles.length&&!g;j++)f=e.mediafiles[j],f.player&&(g=new f.player(b.container),g.compatible||(g=null));else if("companion"===e.type)for(var j=0;j<e.companions.length&&!g;j++)f=e.companions[j],f.player&&(g=new f.player(b.container),g.compatible||(g=null))}if(!g)return void b.trigger("empty",[c]);g.bind("*",function(a,c){b.trigger("player."+a,[g,f,e,c])}),g.print(d,f,e.playerParameters)},function(a,b){});return this},c}(a.xml.Loader,a.xml.Parser),a});